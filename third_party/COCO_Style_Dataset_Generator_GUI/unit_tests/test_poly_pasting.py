import numpy
from PIL import Image, ImageDraw

# read image as RGB and add alpha (transparency)
im = Image.open("images/davi_0_1.jpg").convert("RGBA")

# convert to numpy (for convenience)
imArray = numpy.asarray(im)

# create mask
polygon2 = [(10, 10), (10, 150), (550, 150), (150, 10)]
polygon1 = [(1920, 0), (0, 0), (0, 250), (-0.10210674635236394, 249.77657923687673), (-2.1094657996870403, 255.03379664713123), (17.043357362773406, 256.0158194361004), (19.743585566230458, 257.24042105198055), (15.950897656114186, 254.2993740345912), (27.747904611277534, 250.51951337704952), (27.961274007008967, 253.63518034864092), (29.81425998511483, 255.41115415383845), (37.3667088625533, 256.4373058829165), (46.53380792054146, 243.57254718554756), (53.61176555130789, 244.36644634912406), (49.558319074426926, 245.93258750036037), (60.33955511927042, 255.83254114007315), (65.73851977273596, 255.91269387461898), (76.73575480091465, 247.02704108128736), (78.34805771376494, 248.17030289093188), (86.05632662995261, 258.41364572544853), (87.85472059685605, 251.9630660275433), (89.80188097115189, 244.4785932629154), (92.31760033899944, 253.8264647999193), (103.48680386603161, 259.5970120020665), (108.79236707446952, 260.23761745739506), (107.4937793054668, 254.30466090801215), (108.39358602655307, 246.14079063076383), (126.52486800617761, 257.098422070827), (126.89943745269167, 250.1957195389658), (132.02691150565755, 256.48412988536154), (128.58195282301338, 252.79775783620423), (136.47572160588913, 254.4441395133314), (146.75086407853183, 260.1350693035284), (155.073813275849, 254.85850113146446), (151.97302312432186, 251.33687712540114), (157.34863597011744, 256.9711603194696), (165.3621223224169, 259.44430066082975), (169.10946867961437, 248.41407201625222), (181.09443326356882, 254.04993377735954), (175.70858911880558, 258.2380301719833), (192.00679423643666, 252.91711095845895), (189.1673649545458, 252.21181387583448), (195.83368997955725, 259.6731833553506), (194.61216526235634, 257.67985807616327), (199.59668919652594, 256.86696909739544), (204.89929126562438, 256.3404560825), (209.62014250508463, 255.07011440400703), (212.07706747647595, 261.4557434304978), (229.96134579284376, 255.64160167491366), (232.43428089908423, 251.83975180535887), (229.90018481610127, 257.0135552875774), (234.80672832203157, 248.76310236447264), (243.25042358036447, 261.17495400508494), (249.68932632608966, 264.0681882162521), (255.74368446785104, 262.8189134037273), (255.5330016557221, 254.57174601013634), (260.2653123071998, 262.97142577117904), (264.09858509159926, 258.1544814168108), (275.24555974843247, 256.19194127041214), (286.24564412575853, 259.7104454066601), (284.71754162529976, 253.71317013201232), (293.4762533829063, 253.6635985653496), (290.6949362189203, 265.3365355964029), (294.1761306148136, 262.35245809288574), (310.2766731170838, 256.2427436783204), (317.2399732326495, 257.19080664472693), (318.39042410523496, 265.2841360754873), (319.912104059165, 264.8216512714212), (322.3480129044327, 261.86773581034964), (335.9036887305486, 264.88653554479106), (332.97228370177675, 259.16014609412684), (345.1352331564961, 266.03635464878687), (343.0437539721002, 260.35448821806597), (345.6416745691777, 260.1597059242849), (358.9043367621447, 258.522277196598), (355.00847219311873, 267.1244254191321), (367.51940391677755, 262.3069070377452), (369.4275875033949, 259.7016001436432), (371.9099373501995, 257.8257422068458), (374.5192933499681, 262.0863919259926), (383.172995439416, 265.1345723510826), (396.01114440021024, 263.90263357113616), (390.24183439053525, 267.98438605429095), (394.50876485297516, 257.40461928296986), (404.1138037652838, 267.63878806317155), (407.84839944051527, 259.36014224577974), (410.919296661234, 261.85406598934696), (413.3293143874036, 263.91645457293714), (419.7131771063948, 259.54884010662346), (427.7662396620981, 255.74355444558074), (438.56674757484996, 267.1465872195995), (438.1531997489801, 255.3327554352958), (441.19632661544046, 267.60841321814763), (450.43222343773203, 267.4037487393895), (455.0688973027098, 263.37794907150123), (453.4182917377982, 263.8641406049655), (469.5434250354823, 255.67725466245275), (470.0239369093112, 263.1880594155271), (482.66468791948625, 264.4754668271869), (476.56821722377003, 260.42230020262724), (482.40435887795024, 257.6951553927151), (487.11101097139226, 269.3935423402255), (491.99594703611876, 268.42034465075585), (505.8730055363312, 269.9189989091135), (511.36354389993227, 268.8852381895841), (508.8427022427122, 255.49268088650217), (513.1562881258143, 268.7633911410157), (526.2263542918532, 258.19196773685854), (526.0073515650495, 267.1479755341373), (529.7346706077001, 255.86130326839367), (536.4154971134869, 267.2665393334687), (544.2924475692166, 268.4048756073015), (550.7572294528655, 263.18181636674143), (542.5747604062316, 266.969882094905), (553.2932763962233, 258.29260061906234), (561.568113536864, 261.6030899809526), (560.7561201526694, 261.4482858902076), (564.4975123154929, 262.25141631808634), (581.2948318079701, 265.66724825588926), (581.9996036242798, 273.0651590172597), (589.3393708500435, 263.18587292520607), (590.827050456112, 272.29054248597595), (601.3159591714563, 258.876416064304), (605.6895264461832, 263.77240113762724), (598.5479944983696, 264.6687239762898), (615.5179812848138, 265.3864130446329), (608.9819231550235, 263.2508931106562), (620.421177359739, 270.54726731145485), (625.3075827317724, 259.75011186505895), (622.98436600077, 262.85296860715397), (639.2744468627925, 264.78305853530514), (643.1987841328669, 271.51223837781464), (649.2456961792811, 270.7200332338785), (650.2218274586423, 267.27606166920185), (647.56809791391, 270.2774386070881), (656.0993885240471, 266.34473794767604), (661.2246165387108, 261.55653405025583), (666.745638042081, 270.64838369739886), (673.1379136890687, 275.33916998409853), (682.9043535840688, 274.86915990335575), (678.5437019799954, 261.9133566885317), (688.5923356626867, 269.0599110304343), (693.7563354659698, 274.336248899017), (693.0202606374799, 263.60496018648337), (698.4000849399749, 261.7219308217077), (712.7875555474909, 272.6578667172132), (708.0655270091651, 263.1472040695353), (722.8961634797217, 270.80034882757894), (728.2438636119088, 270.86391665040594), (732.8865069126186, 262.13229555563095), (734.9628651080236, 261.5314805455938), (743.5079064112757, 269.6097211440626), (740.626661435203, 265.6040164357563), (756.0919992495631, 268.85730703537445), (760.3331171117211, 273.987114566834), (752.3195033731063, 267.630395860822), (762.1406114005654, 271.1688795410745), (768.4437436990225, 272.39100423802495), (769.6389614278111, 270.4043033219978), (786.1774454092401, 277.41811756327735), (792.5531569050898, 275.2998134104807), (788.4294583537404, 263.976887084107), (789.5846895631001, 273.34417608726073), (799.3040642927632, 272.98107600129674), (805.3373408398285, 271.2588716882814), (806.4432370898028, 270.665206353944), (813.921755369561, 274.6760175601746), (814.7106002905416, 274.9489436528596), (822.7174022115418, 275.84736676695366), (822.7715307130898, 276.91376426612067), (835.3152010060019, 266.61597337847604), (839.0251903726219, 277.75101004140157), (837.3187189218118, 272.2690890341042), (842.7875201664002, 278.7262473668461), (847.6349544981093, 268.3231832424176), (863.3217136149369, 277.02232939469394), (859.7262946299107, 276.7703367556846), (863.7880789134827, 274.60428393906585), (870.3671267554245, 276.2733166819531), (877.1124027696003, 265.3715964818472), (879.2350545295685, 280.27982157897986), (896.8258910971084, 273.5642812777275), (898.8418404955643, 266.02345907389315), (900.5798761970904, 273.36036361952847), (899.300040800521, 272.7243713886492), (917.3163420965044, 279.4676551787424), (921.2251894050358, 269.57946855637545), (914.8786340829956, 271.6213646027582), (929.7815950364192, 273.59603216135093), (935.8990995172119, 267.12332074367674), (936.770914819462, 268.86161663514883), (946.9510772677363, 268.5616084016788), (945.1090418541772, 271.63002043863486), (942.6135746981644, 279.0405218802981), (947.4031691602536, 267.64844980366576), (963.308020723541, 281.4072838592242), (958.526277391257, 267.4322053687551), (969.3113280992739, 280.4159148353725), (975.5933386199479, 271.54884438561976), (973.5351087221619, 280.477159190593), (992.5091920918983, 275.134531859925), (997.5962738460184, 274.16389099925846), (998.2185045124364, 274.0892680535451), (1000.3270383443931, 277.6329263772447), (998.242967122664, 273.5531216987363), (1007.2733979562806, 274.1074891524873), (1007.6674906228562, 272.7188177589547), (1016.050636562134, 269.4085065957457), (1019.318297961289, 284.20426178533575), (1024.7839983400452, 282.27450945417013), (1041.4561525467411, 274.48930825320787), (1032.8974521000166, 285.0532235514212), (1051.391282669397, 274.90552549133025), (1049.8697645586783, 277.4922759095924), (1053.2509316910198, 279.4522734710789), (1052.4291462714991, 285.1237425296172), (1066.8577125250429, 278.1120294093625), (1073.949309620567, 274.6044886492283), (1075.8234437321937, 283.0205704762114), (1079.430319815726, 276.53601428079725), (1090.8896131595122, 277.72749578809254), (1094.6113858780475, 276.6308238133251), (1092.7122113823248, 283.81246537338643), (1101.1044383069905, 271.29485215064744), (1100.3982100593685, 283.6342384084046), (1103.17977159758, 279.3013875999353), (1110.6335799905085, 276.9264175278924), (1124.300727191119, 273.7476083350614), (1121.0250558379662, 275.88672370900724), (1136.7781977290326, 273.94777811196263), (1133.0345416992195, 272.66019532390925), (1135.8288733295954, 286.0490023877359), (1145.7834905455275, 277.8800304939227), (1142.0127304070766, 282.8126173213673), (1150.060747167361, 287.7084882287928), (1158.9967507454728, 280.45919830340813), (1167.3888976122614, 274.9379811976714), (1177.2876731662539, 283.7513561928875), (1172.2685221274166, 278.9040120377208), (1182.8736182492496, 280.02716567750986), (1192.9272423641341, 285.80274365563747), (1196.1934987498205, 287.8499386559872), (1192.7912850084322, 287.529547577409), (1206.2510251715257, 284.5882565239575), (1210.8118796783185, 279.9138402489226), (1216.6532202520598, 276.39380107378867), (1219.9432418558035, 283.4282179356329), (1221.11315006636, 285.81077597021374), (1225.6503551627452, 278.6946843620867), (1236.8940345337091, 287.58710541234984), (1228.4538537412402, 283.920342409159), (1237.2036598007837, 279.63062606428446), (1246.498489884122, 280.4379130902805), (1245.3329414253124, 281.3118098936571), (1257.5265714248037, 283.8058866457418), (1263.5881925092442, 282.6220767968771), (1266.8598904640346, 285.14621747402725), (1276.7455211932797, 290.25488018060753), (1273.8391422339619, 285.439870633802), (1275.6736181570277, 285.1375300702421), (1284.2027740722367, 286.3601863989344), (1283.1242784124656, 276.5288355052286), (1292.5177446485825, 288.77064795998206), (1304.6926802901105, 281.43896552957716), (1309.057868537286, 288.89946980189853), (1305.3713265667188, 282.7528420745641), (1309.4653494633342, 280.84322328766433), (1322.9115501168376, 276.65302855386403), (1324.8654233610569, 291.11524960850863), (1322.1192315439378, 279.28119906645867), (1335.4087081297594, 281.67118812554446), (1337.0719393538936, 287.0839224725788), (1349.7228791617363, 289.27894206619345), (1344.7657802156589, 292.010851903016), (1362.9789806266958, 287.9043158064125), (1365.9896768742876, 284.37043215347114), (1372.1332682139991, 279.4534150799918), (1375.7265635344704, 281.9876869897247), (1371.3695760201686, 288.0756012824648), (1375.4939186809445, 288.57430510672964), (1380.9666508828682, 282.2553694995741), (1393.3197830470465, 278.42515166918975), (1394.8169398019932, 283.56381229701884), (1399.201394063257, 288.4848431829683), (1399.9447905367658, 290.91489498583076), (1412.672356789721, 290.9590207989381), (1421.356419152092, 280.74100684539275), (1424.1674702693583, 284.9364279120107), (1429.682595243649, 292.6247906281175), (1436.9760777419249, 283.1912917687539), (1433.683576693816, 290.51768763691723), (1436.0683610984079, 293.0306217767802), (1448.5553795135531, 282.92297954164394), (1446.1985620420835, 283.12630583151844), (1450.5202520711025, 290.4031533402797), (1462.6324935173911, 290.88736618830944), (1467.495958316436, 285.3245725146651), (1470.4196615644912, 282.70927041991484), (1481.323401999719, 289.51578162582916), (1474.125546028661, 284.38425821911903), (1477.359337062149, 287.33188332209596), (1495.6871346220776, 283.0084533239059), (1495.1967068366064, 286.6635997461865), (1494.282982591961, 290.9184415991366), (1498.502144661068, 289.729253689415), (1511.9546484153993, 284.91162433195103), (1512.2389915420836, 285.440015049375), (1517.5420372756412, 282.26062929527075), (1520.538978516502, 282.5392933333763), (1537.534718617824, 286.86628766611597), (1541.1790157598793, 283.22042060480385), (1544.9362054947, 289.5430833806965), (1544.5217005930315, 286.8878809321911), (1546.3449269904704, 295.01341303724485), (1554.0950025749494, 290.42936342993204), (1560.7834935378316, 291.58256803660987), (1560.4324260320532, 298.13414497465857), (1573.5680831395728, 287.8754887578058), (1580.2112327730063, 296.5453439728025), (1579.9807184968845, 296.4978355205458), (1588.7015904617056, 288.90533644821056), (1595.004199831141, 290.30364617957713), (1597.4577072571958, 298.842138679482), (1605.5290216544904, 290.8060208305865), (1606.217957717263, 298.679073807415), (1617.1247493110718, 287.66355422112275), (1615.274428374421, 291.826794738184), (1624.995711240025, 285.86270742184126), (1625.8300625069712, 294.2077965620291), (1635.7938155181246, 285.80215080016546), (1629.3824611853986, 293.83575974021926), (1639.4529851967375, 289.1994259157376), (1644.9171304552904, 287.50951965509694), (1651.9198923037907, 287.4369470569843), (1659.9851520495888, 291.8711234057065), (1656.5222000432416, 293.07889481132315), (1670.0845726834505, 290.24854973804145), (1671.6859459192694, 289.4573640368861), (1676.4955800036932, 298.36299349992686), (1681.880228863793, 298.2671644192603), (1690.1428702092433, 300.1661873054405), (1683.8456219262723, 298.84772300797295), (1690.9271590592998, 287.662736632823), (1696.2400535531317, 291.88496181030945), (1701.2826058990988, 298.8245602145944), (1704.736487075138, 298.26836857352964), (1721.0531893058453, 299.4216774561701), (1718.53678200437, 292.54395550999243), (1718.6633946885545, 289.7981210184704), (1730.5638565242414, 289.7495077872403), (1740.94042541695, 296.8618871897551), (1742.3248433604049, 292.9443844497491), (1745.416834279689, 295.52678160560856), (1747.2516925589669, 290.93170277293234), (1752.3705235851935, 299.923226694993), (1760.7469568668346, 299.03897827117413), (1761.6144278014483, 301.97364381509107), (1767.9651279305258, 302.7913027221788), (1781.555955824845, 293.7486432755097), (1775.5000635124534, 301.59974624308654), (1782.1689391025593, 290.3418087678853), (1783.652384810308, 300.21792792368984), (1798.7131852375373, 295.4314337053134), (1802.2228982750771, 289.7641118421078), (1805.3105204153078, 290.02724296684556), (1805.845877507224, 296.4778780267972), (1810.6111802027297, 297.7420281629228), (1822.1409852624865, 299.1687968534061), (1827.9047336886124, 299.2892194278894), (1831.5408160691823, 290.75071975313386), (1833.0152989585984, 303.9953009268141), (1836.3764654755892, 295.2842209080913), (1850.7326810430084, 304.5325490782085), (1842.4261841321693, 299.4364064365735), (1860.2057746757157, 301.81160557086326), (1853.4000174515243, 291.16866060095055), (1858.9376726537282, 303.0488109078991), (1871.2607687357843, 295.65438225902045), (1882.256519602529, 302.4389157332479), (1873.7838776904755, 300.2554259849878), (1890.6467814871096, 292.5088482516275), (1884.2715434390298, 298.91862896607904), (1895.1004363469867, 292.1821017569861), (1907.3055130276714, 298.65266239456304), (1911.0265565149812, 291.834461859917), (1906.0452170044769, 292.50877937261305), (1911.6141336497378, 307.13252747915385), (1920, 300)]

maskIm = Image.new('L', (imArray.shape[1], imArray.shape[0]), 0)
ImageDraw.Draw(maskIm).polygon(polygon1, outline=1, fill=1)
mask1 = numpy.array(maskIm)
ImageDraw.Draw(maskIm).polygon(polygon2, outline=1, fill=1)
mask = numpy.array(maskIm)

print (numpy.allclose(mask, mask1))

# assemble new image (uint8: 0-255)
newImArray = numpy.empty(imArray.shape,dtype='uint8')

# colors (three first columns, RGB)
newImArray[:,:,:3] = imArray[:,:,:3]

# transparency (4th column)
newImArray[:,:,3] = mask*255


# back to Image from numpy
newIm = Image.fromarray(newImArray, "RGBA")
newIm.save("out.png")



